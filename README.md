# -
一个基于 AutoHotkey v2 的脚本，用于快速取关微信公众号，帮助老年用户轻松清理订阅列表。
# WeChat Cleaner (AHK v2)

> 🧹 一个基于 [AutoHotkey v2](https://www.autohotkey.com/) 的脚本，用于**快速删除微信公众号**，特别为**老年用户**设计，帮助他们更轻松地清理不需要的订阅。

---

## ✨ 功能特点

- ⚡ **自动点击流程**：模拟人工点击，自动完成公众号删除操作  
- 🔍 **文字图像识别**：通过截取按钮文字（如“确认”“删除”）来识别，避免背景干扰  
- 🎲 **随机延时与抖动**：避免过于机械化的点击，降低误操作风险  
- 🖥️ **全屏坐标支持**：使用 `CoordMode "Screen"`，不受窗口位置影响  
- 👴 **老年友好**：减少复杂操作，一键启动循环，自动运行  

---

## 📦 安装步骤

1. **安装 AutoHotkey v2**
   - 从 [AutoHotkey 官方网站](https://www.autohotkey.com/) 下载并安装 v2 版本
   - 安装完成后，命令行输入 `ahk` 应该能找到执行文件

2. **下载本项目**
   - 点击右上角绿色按钮 **Code → Download ZIP**  
   - 或者在命令行运行：
     ```bash
     git clone https://github.com/你的用户名/SeniorWeChatCleaner.git
     ```

3. **准备按钮文字截图**
   - 用 **Win+Shift+S** 截取第 2、3 步按钮的文字（例如 “确认” 或 “删除”）
   - 保存为 `step2.png` 和 `step3.png`，放到脚本同目录下

---

## ▶️ 使用方法

1. 双击 `wechat_autoclick.ahk` 启动脚本  
2. 打开 **微信 PC 版**，进入公众号管理页面  
3. 按 **F8** 开始循环执行删除操作  
4. 再按 **F8** 停止  
5. 按 **Esc** 退出脚本  

---

## ⚙️ 配置参数

脚本顶部有一些可调参数：

| 参数 | 默认值 | 说明 |
|------|--------|------|
| `Jitter` | `0` | 点击坐标的随机抖动范围 |
| `BetweenMin/Max` | `400/500` | 每步之间的随机延时（毫秒） |
| `BetweenRoundsMin/Max` | `500/2000` | 每轮之间的随机延时 |
| `TimeoutPerStep` | `6000` | 每步查找按钮图像的超时时间（毫秒） |
| `Similarity` | `150` | 图像识别相似度（0-255，数值越大越宽松） |
| `DefaultOffsetX/Y` | `5 / 15` | 点击点相对图片左上角的偏移量 |

根据不同屏幕分辨率和按钮位置，你可以调整这些数值来优化稳定性。  

---

## 📷 示例截图（占位）

这里可以放几张示例截图，演示按钮文字截图和运行效果：

- `step2.png`（确认按钮文字）
- `step3.png`（删除按钮文字）
- 运行时点击演示

---

## 🚨 注意事项

- 请确保微信窗口在前台，并且分辨率、缩放与截图时一致  
- 如果按钮样式有变化（例如高亮/暗色），请重新截取文字图片  
- 建议在测试账号或不重要的公众号上先试运行，确认无误后再批量使用  
- 本项目仅供学习研究，使用时请注意风险  

---

## 📜 License

MIT License  
自由使用、修改和分发，但请自行承担使用风险。
